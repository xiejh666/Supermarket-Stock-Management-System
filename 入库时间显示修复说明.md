# å…¥åº“æ—¶é—´æ˜¾ç¤ºä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

ç‚¹å‡»"ç¡®è®¤å…¥åº“"åï¼Œå…¥åº“æ—¶é—´å·²ç»åœ¨æ•°æ®åº“ä¸­æ›´æ–°ï¼Œä½†å‰ç«¯é¡µé¢æ²¡æœ‰æ˜¾ç¤ºå…¥åº“æ—¶é—´ã€‚

## ğŸ” é—®é¢˜åŸå› 

è™½ç„¶åç«¯Serviceå±‚æ­£ç¡®è®¾ç½®äº†`inboundTime`ï¼š

```java
// PurchaseOrderServiceImpl.java
order.setStatus(3); // å·²å…¥åº“
order.setInboundTime(LocalDateTime.now()); // è®¾ç½®å…¥åº“æ—¶é—´
purchaseOrderMapper.updateById(order);
```

ä½†æ˜¯å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

### 1. VOç±»ç¼ºå°‘å­—æ®µ
`PurchaseOrderVO.java` ä¸­æ²¡æœ‰å®šä¹‰ `inboundTime` å­—æ®µï¼Œå¯¼è‡´æ— æ³•ä¼ é€’åˆ°å‰ç«¯ã€‚

### 2. Mapper SQLæŸ¥è¯¢ç¼ºå°‘å­—æ®µ
`PurchaseOrderMapper.xml` çš„SQLæŸ¥è¯¢ä¸­æ²¡æœ‰æŸ¥è¯¢ `inbound_time` å­—æ®µï¼Œå¯¼è‡´æ•°æ®æ— æ³•ä»æ•°æ®åº“è¯»å–ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹1ï¼šæ·»åŠ å­—æ®µåˆ°VOç±»

**æ–‡ä»¶**: `PurchaseOrderVO.java`

```java
@ApiModelProperty("å…¥åº“æ—¶é—´")
@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
private LocalDateTime inboundTime;
```

### ä¿®æ”¹2ï¼šæ›´æ–°Mapperçš„ResultMap

**æ–‡ä»¶**: `PurchaseOrderMapper.xml`

```xml
<resultMap id="PurchaseOrderVOMap" type="com.supermarket.vo.PurchaseOrderVO">
    <!-- ... å…¶ä»–å­—æ®µ ... -->
    <result column="audit_time" property="auditTime"/>
    <result column="audit_remark" property="auditRemark"/>
    <result column="inbound_time" property="inboundTime"/>  <!-- æ–°å¢ -->
    <result column="create_time" property="createTime"/>
</resultMap>
```

### ä¿®æ”¹3ï¼šæ›´æ–°SQLæŸ¥è¯¢è¯­å¥

**æ–‡ä»¶**: `PurchaseOrderMapper.xml`

åœ¨ä¸¤ä¸ªæŸ¥è¯¢æ–¹æ³•ä¸­éƒ½æ·»åŠ  `po.inbound_time` å­—æ®µï¼š

#### selectPurchaseOrderVOList
```xml
<select id="selectPurchaseOrderVOList" resultMap="PurchaseOrderVOMap">
    SELECT
        po.id,
        po.order_no,
        po.supplier_id,
        s.supplier_name,
        po.total_amount,
        po.status,
        po.applicant_id,
        u1.real_name AS applicant_name,
        po.auditor_id,
        u2.real_name AS auditor_name,
        po.audit_time,
        po.audit_remark,
        po.inbound_time,  <!-- æ–°å¢ -->
        po.create_time
    FROM purchase_order po
    -- ... å…¶ä»–SQL ...
</select>
```

#### selectPurchaseOrderVOById
```xml
<select id="selectPurchaseOrderVOById" resultMap="PurchaseOrderVOMap">
    SELECT
        po.id,
        po.order_no,
        po.supplier_id,
        s.supplier_name,
        po.total_amount,
        po.status,
        po.applicant_id,
        u1.real_name AS applicant_name,
        po.auditor_id,
        u2.real_name AS auditor_name,
        po.audit_time,
        po.audit_remark,
        po.inbound_time,  <!-- æ–°å¢ -->
        po.create_time
    FROM purchase_order po
    -- ... å…¶ä»–SQL ...
</select>
```

## ğŸ“Š æ•°æ®æµå‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®æµå‘å›¾                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ ç”¨æˆ·ç‚¹å‡»"ç¡®è®¤å…¥åº“"
   â†“
2ï¸âƒ£ å‰ç«¯è°ƒç”¨ confirmInbound API
   â†“
3ï¸âƒ£ åç«¯ Service å±‚
   - æ›´æ–°åº“å­˜
   - order.setInboundTime(LocalDateTime.now()) âœ…
   - order.setStatus(3)
   - purchaseOrderMapper.updateById(order)
   â†“
4ï¸âƒ£ æ•°æ®åº“ purchase_order è¡¨
   - inbound_time å­—æ®µå·²æ›´æ–° âœ…
   â†“
5ï¸âƒ£ å‰ç«¯åˆ·æ–°åˆ—è¡¨ loadData()
   â†“
6ï¸âƒ£ åç«¯ Mapper æŸ¥è¯¢
   - SELECT po.inbound_time âœ… (ä¿®å¤å)
   â†“
7ï¸âƒ£ VO å¯¹è±¡
   - inboundTime å­—æ®µ âœ… (ä¿®å¤å)
   â†“
8ï¸âƒ£ JSON å“åº”
   - "inboundTime": "2025-11-17 17:15:30" âœ…
   â†“
9ï¸âƒ£ å‰ç«¯é¡µé¢æ˜¾ç¤º
   - å…¥åº“æ—¶é—´åˆ—æ˜¾ç¤ºæ—¶é—´ âœ…
```

## ğŸ¯ å‰ç«¯æ˜¾ç¤º

å‰ç«¯å·²ç»æ­£ç¡®é…ç½®äº†æ˜¾ç¤ºé€»è¾‘ï¼š

### åˆ—è¡¨é¡µ
```vue
<el-table-column prop="inboundTime" label="å…¥åº“æ—¶é—´" width="180" />
```

### è¯¦æƒ…é¡µ
```vue
<el-descriptions-item label="å…¥åº“æ—¶é—´">
  {{ formatTime(viewData.inboundTime) }}
</el-descriptions-item>
```

### æ—¶é—´æ ¼å¼åŒ–
```javascript
const formatTime = (time) => {
  if (!time) return '-'
  return new Date(time).toLocaleString('zh-CN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  })
}
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ç¡®è®¤æ•°æ®åº“å­—æ®µå­˜åœ¨
```sql
-- æ£€æŸ¥ inbound_time å­—æ®µ
DESC purchase_order;

-- å¦‚æœä¸å­˜åœ¨ï¼Œæ‰§è¡Œï¼š
ALTER TABLE `purchase_order` 
ADD COLUMN `inbound_time` DATETIME DEFAULT NULL COMMENT 'å…¥åº“æ—¶é—´' 
AFTER `audit_remark`;
```

### 2. é‡å¯åç«¯æœåŠ¡
```bash
cd d:\code\supermarket-system\supermarket-backend
mvn spring-boot:run
```

### 3. åˆ·æ–°å‰ç«¯é¡µé¢
æŒ‰ `Ctrl + F5` å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨

## âœ… æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤
```
1. åˆ›å»ºé‡‡è´­å•ï¼ˆçŠ¶æ€ï¼šå¾…å®¡æ ¸ï¼‰
   - ç¡®è®¤"å…¥åº“æ—¶é—´"åˆ—æ˜¾ç¤º "-"
   
2. ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡ï¼ˆçŠ¶æ€ï¼šå¾…å…¥åº“ï¼‰
   - ç¡®è®¤"å…¥åº“æ—¶é—´"åˆ—ä»æ˜¾ç¤º "-"
   
3. ç‚¹å‡»"ç¡®è®¤å…¥åº“"ï¼ˆçŠ¶æ€ï¼šå·²å…¥åº“ï¼‰
   - ç¡®è®¤"å…¥åº“æ—¶é—´"åˆ—æ˜¾ç¤ºå…·ä½“æ—¶é—´ âœ…
   - æ ¼å¼ï¼š2025-11-17 17:15:30
   
4. ç‚¹å‡»"è¯¦æƒ…"æŒ‰é’®
   - ç¡®è®¤è¯¦æƒ…é¡µæ˜¾ç¤ºå…¥åº“æ—¶é—´ âœ…
```

### é¢„æœŸç»“æœ

**åˆ—è¡¨é¡µæ˜¾ç¤º**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡‡è´­å•å·      â”‚ ä¾›åº”å•† â”‚ æ€»é‡‘é¢ â”‚ çŠ¶æ€   â”‚ é‡‡è´­æ—¶é—´          â”‚ å…¥åº“æ—¶é—´          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PO20251117... â”‚ å¯å£å¯ä¹â”‚ Â¥150  â”‚ å¾…å®¡æ ¸ â”‚ 2025-11-17 10:00 â”‚ -                â”‚
â”‚ PO20251117... â”‚ ç™¾äº‹å¯ä¹â”‚ Â¥200  â”‚ å¾…å…¥åº“ â”‚ 2025-11-17 09:00 â”‚ -                â”‚
â”‚ PO20251116... â”‚ é›ªç¢§    â”‚ Â¥180  â”‚ å·²å…¥åº“ â”‚ 2025-11-16 14:00 â”‚ 2025-11-16 15:30 â”‚ âœ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¯¦æƒ…é¡µæ˜¾ç¤º**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é‡‡è´­è®¢å•è¯¦æƒ…                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é‡‡è´­å•å·    â”‚ PO202511160001           â”‚
â”‚ ä¾›åº”å•†      â”‚ é›ªç¢§å…¬å¸                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é‡‡è´­æ—¶é—´    â”‚ 2025-11-16 14:00:00      â”‚
â”‚ æ€»é‡‘é¢      â”‚ Â¥180.00                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€        â”‚ [å·²å…¥åº“] (ç»¿è‰²æ ‡ç­¾)      â”‚
â”‚ å…¥åº“æ—¶é—´    â”‚ 2025-11-16 15:30:00      â”‚ âœ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. âœ… `PurchaseOrderVO.java` - æ·»åŠ  inboundTime å­—æ®µ
2. âœ… `PurchaseOrderMapper.xml` - æ·»åŠ  inbound_time åˆ° ResultMap å’Œ SQL æŸ¥è¯¢

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### JSONåºåˆ—åŒ–
```java
@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
private LocalDateTime inboundTime;
```

è¿™ä¸ªæ³¨è§£ç¡®ä¿ï¼š
- åç«¯è¿”å›çš„æ—¶é—´æ ¼å¼ç»Ÿä¸€
- å‰ç«¯æ¥æ”¶åˆ°çš„æ˜¯æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²
- é¿å…æ—¶åŒºé—®é¢˜

### MyBatisæ˜ å°„
```xml
<result column="inbound_time" property="inboundTime"/>
```

è¿™ä¸ªæ˜ å°„ç¡®ä¿ï¼š
- æ•°æ®åº“å­—æ®µ `inbound_time` (ä¸‹åˆ’çº¿)
- Javaå±æ€§ `inboundTime` (é©¼å³°)
- è‡ªåŠ¨è½¬æ¢

## ğŸ“ æ€»ç»“

### é—®é¢˜æœ¬è´¨
æ•°æ®åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œä½†ç”±äºVOç±»å’ŒMapperæŸ¥è¯¢ç¼ºå°‘å­—æ®µå®šä¹‰ï¼Œå¯¼è‡´æ•°æ®æ— æ³•ä¼ é€’åˆ°å‰ç«¯ã€‚

### è§£å†³å…³é”®
1. VOç±»æ·»åŠ å­—æ®µå®šä¹‰
2. Mapperæ·»åŠ ResultMapæ˜ å°„
3. SQLæŸ¥è¯¢æ·»åŠ å­—æ®µæŸ¥è¯¢

### ç»éªŒæ•™è®­
åœ¨æ·»åŠ æ–°å­—æ®µæ—¶ï¼Œéœ€è¦ç¡®ä¿å®Œæ•´çš„æ•°æ®æµï¼š
```
æ•°æ®åº“å­—æ®µ â†’ Mapper SQL â†’ ResultMap â†’ VOç±» â†’ JSONå“åº” â†’ å‰ç«¯æ˜¾ç¤º
```

ä»»ä½•ä¸€ä¸ªç¯èŠ‚ç¼ºå¤±éƒ½ä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ä¼ é€’ã€‚

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-11-17 17:15  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶ç¼–è¯‘é€šè¿‡  
**å½±å“èŒƒå›´**: é‡‡è´­ç®¡ç†æ¨¡å— - å…¥åº“æ—¶é—´æ˜¾ç¤º
