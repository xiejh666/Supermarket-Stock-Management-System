# 超市库存管理系统 - 数据导入说明

## 📊 数据概览

本次生成的数据包含：

### 数据周期
- **开始日期**: 2024年7月1日
- **结束日期**: 2024年11月30日
- **时间跨度**: 5个月

### 数据统计
- **商品分类**: 15个（含二级分类）
- **供应商**: 15个（真实企业名称）
- **客户**: 100个
- **商品**: 60个（真实超市商品）
- **采购订单**: 714个
- **采购明细**: 1,275条
- **销售订单**: 4,888个
- **销售明细**: 23,434条
- **库存记录**: 60条

### 库存验证
- **总采购量**: 74,243件
- **总销售量**: 45,694件
- **当前库存**: 28,549件
- **验证公式**: ✅ 库存 = 采购 - 销售 (74,243 - 45,694 = 28,549)

## 📁 生成的文件

1. **生成真实超市数据.py** - 数据生成脚本
2. **supermarket_真实数据_完整版.sql** - 完整的SQL数据文件（约31,000行）

## 🚀 导入步骤

### 方法一：使用命令行导入（推荐）

```bash
# 进入sql目录
cd d:\code\supermarket-system\sql

# 导入数据（Windows PowerShell）
Get-Content supermarket_真实数据_完整版.sql | mysql -uroot -proot supermarket_db

# 或者使用传统命令（可能会有编码问题）
mysql -uroot -proot supermarket_db < supermarket_真实数据_完整版.sql
```

### 方法二：使用MySQL Workbench导入

1. 打开MySQL Workbench
2. 连接到数据库
3. 选择 `File` -> `Run SQL Script`
4. 选择 `supermarket_真实数据_完整版.sql` 文件
5. 点击 `Run` 执行

### 方法三：使用Navicat导入

1. 打开Navicat
2. 连接到 `supermarket_db` 数据库
3. 右键数据库 -> `Execute SQL File`
4. 选择 `supermarket_真实数据_完整版.sql` 文件
5. 点击 `Start` 执行

## ⚠️ 注意事项

### 导入前准备

1. **备份现有数据**（如果有重要数据）
   ```sql
   mysqldump -uroot -proot supermarket_db > backup_$(date +%Y%m%d).sql
   ```

2. **确保数据库存在**
   ```sql
   CREATE DATABASE IF NOT EXISTS supermarket_db DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```

3. **确保用户表数据存在**
   - 本SQL文件会清空业务数据，但**不会清空用户表**（sys_user、sys_role等）
   - 请确保已有管理员账号，否则无法登录系统

### 数据清理说明

SQL文件会自动清空以下表的数据：
- ✅ `category` - 商品分类
- ✅ `supplier` - 供应商
- ✅ `customer` - 客户
- ✅ `product` - 商品
- ✅ `purchase_order` - 采购订单
- ✅ `purchase_order_item` - 采购明细
- ✅ `sale_order` - 销售订单
- ✅ `sale_order_item` - 销售明细
- ✅ `inventory` - 库存
- ✅ `inventory_log` - 库存日志
- ✅ `message_notification` - 消息通知
- ✅ `system_notification` - 系统通知

**不会清空**的表：
- ❌ `sys_user` - 用户表
- ❌ `sys_role` - 角色表
- ❌ `sys_permission` - 权限表
- ❌ `sys_role_permission` - 角色权限关联表
- ❌ `system_config` - 系统配置表
- ❌ `user_config` - 用户配置表

## 📦 数据特点

### 1. 商品分类（15个）
- 食品饮料（粮油调味、休闲零食、饮料冲调、乳品冷饮）
- 日用百货（清洁用品、纸品湿巾、个人护理）
- 生鲜食品（蔬菜水果、肉禽蛋品）
- 家居生活（厨房用品、收纳整理）

### 2. 供应商（15个）
真实企业名称，包括：
- 康师傅、统一、可口可乐、百事
- 伊利、蒙牛、光明
- 宝洁、联合利华、立白
- 金龙鱼、维达、雀巢、娃哈哈、双汇

### 3. 商品（60个）
真实超市商品，包括：
- 粮油调味：金龙鱼调和油、福临门大米、海天酱油等
- 休闲零食：乐事薯片、奥利奥饼干、德芙巧克力等
- 饮料冲调：可口可乐、康师傅冰红茶、农夫山泉等
- 乳品冷饮：伊利纯牛奶、蒙牛特仑苏、安慕希酸奶等
- 清洁用品：立白洗衣液、威猛先生洁厕液等
- 纸品湿巾：维达卷纸、清风抽纸等
- 个人护理：海飞丝洗发水、高露洁牙膏等
- 生鲜食品：新鲜蔬菜、水果、肉类、鸡蛋等

### 4. 采购订单（714个）
- 时间分布：2024年7月1日 - 11月30日
- 采购频率：每周2-3次（周二、周四、周六）
- 订单状态：全部已入库（status=3）
- 审核流程：申请人ID=2（采购员），审核人ID=1（管理员）

### 5. 销售订单（4,888个）
- 时间分布：2024年7月1日 - 11月30日
- 每日订单：工作日20-35单，周末30-50单
- 营业时间：8:00-22:00
- 客户比例：70%有客户信息，30%散客
- 支付状态：95%已支付，5%待支付
- 每单商品：2-8种商品

### 6. 库存数据（60条）
- **严格保证**：库存 = 采购 - 销售
- 预警数量：普通商品10件，生鲜商品20件
- 无负库存情况

## 🔍 数据验证

导入完成后，可以执行以下SQL验证数据：

```sql
-- 1. 查看数据统计
SELECT 
    '商品分类' as 项目, COUNT(*) as 数量 FROM category
UNION ALL
SELECT '供应商', COUNT(*) FROM supplier
UNION ALL
SELECT '客户', COUNT(*) FROM customer
UNION ALL
SELECT '商品', COUNT(*) FROM product
UNION ALL
SELECT '采购订单', COUNT(*) FROM purchase_order
UNION ALL
SELECT '销售订单', COUNT(*) FROM sale_order
UNION ALL
SELECT '库存记录', COUNT(*) FROM inventory;

-- 2. 验证库存公式（库存 = 采购 - 销售）
SELECT 
    p.product_name as 商品名称,
    IFNULL(purchase.total_qty, 0) as 采购总量,
    IFNULL(sale.total_qty, 0) as 销售总量,
    i.quantity as 当前库存,
    (IFNULL(purchase.total_qty, 0) - IFNULL(sale.total_qty, 0)) as 计算库存,
    CASE 
        WHEN i.quantity = (IFNULL(purchase.total_qty, 0) - IFNULL(sale.total_qty, 0)) 
        THEN '✓ 正确' 
        ELSE '✗ 错误' 
    END as 验证结果
FROM product p
LEFT JOIN inventory i ON p.id = i.product_id
LEFT JOIN (
    SELECT product_id, SUM(quantity) as total_qty
    FROM purchase_order_item
    GROUP BY product_id
) purchase ON p.id = purchase.product_id
LEFT JOIN (
    SELECT product_id, SUM(quantity) as total_qty
    FROM sale_order_item
    GROUP BY product_id
) sale ON p.id = sale.product_id
ORDER BY p.id;

-- 3. 查看销售趋势（按月统计）
SELECT 
    DATE_FORMAT(create_time, '%Y-%m') as 月份,
    COUNT(*) as 订单数,
    SUM(total_amount) as 销售额,
    ROUND(AVG(total_amount), 2) as 平均客单价
FROM sale_order
WHERE status = 1
GROUP BY DATE_FORMAT(create_time, '%Y-%m')
ORDER BY 月份;

-- 4. 查看库存预警
SELECT 
    p.product_code as 商品编码,
    p.product_name as 商品名称,
    c.category_name as 分类,
    i.quantity as 当前库存,
    i.warning_quantity as 预警数量,
    CASE 
        WHEN i.quantity <= i.warning_quantity THEN '⚠️ 需要补货'
        ELSE '✓ 库存充足'
    END as 库存状态
FROM inventory i
JOIN product p ON i.product_id = p.id
JOIN category c ON p.category_id = c.id
ORDER BY i.quantity ASC;

-- 5. 查看热销商品TOP10
SELECT 
    p.product_name as 商品名称,
    c.category_name as 分类,
    SUM(si.quantity) as 销售数量,
    SUM(si.total_price) as 销售额,
    COUNT(DISTINCT si.order_id) as 订单数
FROM sale_order_item si
JOIN product p ON si.product_id = p.id
JOIN category c ON p.category_id = c.id
GROUP BY si.product_id, p.product_name, c.category_name
ORDER BY 销售数量 DESC
LIMIT 10;
```

## 🎯 使用建议

1. **开发测试**：数据量适中，适合功能测试和性能测试
2. **演示展示**：真实的商品和供应商名称，更具说服力
3. **数据分析**：5个月的数据可以进行趋势分析、销售预测等
4. **报表测试**：可以测试各种统计报表的准确性

## 🔄 重新生成数据

如果需要重新生成数据，只需运行：

```bash
cd d:\code\supermarket-system\sql
python 生成真实超市数据.py
```

生成的SQL文件会自动覆盖旧文件。

## 📞 问题反馈

如果导入过程中遇到问题：

1. **编码问题**：确保MySQL使用UTF-8编码
2. **外键约束**：SQL文件已自动处理外键检查
3. **权限问题**：确保MySQL用户有足够的权限
4. **内存不足**：可以分批导入或增加MySQL内存配置

---

**生成时间**: 2025-12-10
**数据版本**: v1.0
**脚本版本**: Python 3.x
