# è¶…å¸‚è¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ - å‰ç«¯å¯åŠ¨æŒ‡å— ğŸš€

## ğŸ“‹ ç›®å½•

- [æ–¹å¼ä¸€ï¼šå¼€å‘æ¨¡å¼å¯åŠ¨ï¼ˆæ¨èå¼€å‘é˜¶æ®µï¼‰](#æ–¹å¼ä¸€å¼€å‘æ¨¡å¼å¯åŠ¨æ¨èå¼€å‘é˜¶æ®µ)
- [æ–¹å¼äºŒï¼šç”Ÿäº§æ¨¡å¼ + Nginx åå‘ä»£ç†ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰](#æ–¹å¼äºŒç”Ÿäº§æ¨¡å¼--nginx-åå‘ä»£ç†æ¨èç”Ÿäº§ç¯å¢ƒ)

---

## æ–¹å¼ä¸€ï¼šå¼€å‘æ¨¡å¼å¯åŠ¨ï¼ˆæ¨èå¼€å‘é˜¶æ®µï¼‰

### ğŸ“ å‰ç½®æ¡ä»¶

ç¡®ä¿å·²å®‰è£…ï¼š
- **Node.js** (æ¨è v16+ æˆ– v18+)
- **npm** (é€šå¸¸éš Node.js ä¸€èµ·å®‰è£…)

æ£€æŸ¥ç‰ˆæœ¬ï¼š
```bash
node -v
npm -v
```

---

### ğŸš€ å¿«é€Ÿå¯åŠ¨æ­¥éª¤

#### 1. è¿›å…¥å‰ç«¯ç›®å½•
```bash
cd D:\code\supermarket-system\supermarket-frontend
```

#### 2. å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
```bash
npm install
```

> å¦‚æœå®‰è£…é€Ÿåº¦æ…¢ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒï¼š
> ```bash
> npm config set registry https://registry.npmmirror.com
> npm install
> ```

#### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### 4. è®¿é—®åº”ç”¨
æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€æˆ–æ‰‹åŠ¨è®¿é—®ï¼š
```
http://localhost:5173
```

---

### âš™ï¸ å¼€å‘æ¨¡å¼ç‰¹ç‚¹

âœ… **ä¼˜ç‚¹**ï¼š
- çƒ­æ›´æ–°ï¼ˆä¿®æ”¹ä»£ç åè‡ªåŠ¨åˆ·æ–°ï¼‰
- å®æ—¶é”™è¯¯æç¤º
- å¼€å‘å·¥å…·æ”¯æŒ
- å¿«é€Ÿè°ƒè¯•

âŒ **ç¼ºç‚¹**ï¼š
- ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒ
- æ€§èƒ½æœªä¼˜åŒ–
- éœ€è¦ä¿æŒå‘½ä»¤è¡Œçª—å£æ‰“å¼€

---

## æ–¹å¼äºŒï¼šç”Ÿäº§æ¨¡å¼ + Nginx åå‘ä»£ç†ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

### ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šæ„å»ºå‰ç«¯é¡¹ç›®

#### 1. è¿›å…¥å‰ç«¯ç›®å½•
```bash
cd D:\code\supermarket-system\supermarket-frontend
```

#### 2. æ‰§è¡Œæ„å»ºå‘½ä»¤
```bash
npm run build
```

æ„å»ºå®Œæˆåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆ `dist` æ–‡ä»¶å¤¹ï¼ŒåŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶ã€‚

---

### ğŸŒ ç¬¬äºŒæ­¥ï¼šé…ç½® Nginx

#### 1. ä¸‹è½½å¹¶å®‰è£… Nginx

**Windows ä¸‹è½½åœ°å€**ï¼š
- å®˜ç½‘ï¼šhttp://nginx.org/en/download.html
- ä¸‹è½½ `nginx/Windows-x.x.x` ç‰ˆæœ¬
- è§£å‹åˆ°ä»»æ„ç›®å½•ï¼ˆä¾‹å¦‚ï¼š`D:\nginx`ï¼‰

#### 2. é…ç½® Nginx

æ‰“å¼€ `D:\nginx\conf\nginx.conf`ï¼Œä¿®æ”¹é…ç½®ï¼š

```nginx
# Nginx é…ç½®æ–‡ä»¶
# è¶…å¸‚è¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ

worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    
    sendfile        on;
    keepalive_timeout  65;

    # åç«¯æœåŠ¡å™¨ï¼ˆSpring Bootï¼‰
    upstream backend {
        server 127.0.0.1:8080;
    }

    # ä¸»æœåŠ¡å™¨é…ç½®
    server {
        listen       80;
        server_name  localhost;
        
        # å‰ç«¯é™æ€æ–‡ä»¶
        location / {
            root   D:/code/supermarket-system/supermarket-frontend/dist;
            index  index.html;
            try_files $uri $uri/ /index.html;  # æ”¯æŒ Vue Router History æ¨¡å¼
        }

        # åç«¯ API åå‘ä»£ç†
        location /api/ {
            proxy_pass http://backend/api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            
            # æ”¯æŒ WebSocketï¼ˆå¦‚æœéœ€è¦ï¼‰
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }

        # Gzip å‹ç¼©ä¼˜åŒ–
        gzip on;
        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_types text/plain text/css text/xml text/javascript 
                   application/json application/javascript application/xml+rss 
                   application/rss+xml font/truetype font/opentype 
                   application/vnd.ms-fontobject image/svg+xml;

        # é”™è¯¯é¡µé¢
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
```

**âš ï¸ æ³¨æ„**ï¼š
- å°† `D:/code/supermarket-system/supermarket-frontend/dist` æ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„
- Windows è·¯å¾„ä½¿ç”¨æ­£æ–œæ  `/` è€Œéåæ–œæ  `\`

---

#### 3. å¯åŠ¨ Nginx

##### Windows å¯åŠ¨æ–¹å¼

**æ–¹å¼ 1ï¼šå‘½ä»¤è¡Œå¯åŠ¨**
```bash
cd D:\nginx
start nginx
```

**æ–¹å¼ 2ï¼šåŒå‡»å¯åŠ¨**
åŒå‡» `nginx.exe` æ–‡ä»¶

**æ£€æŸ¥æ˜¯å¦å¯åŠ¨æˆåŠŸ**ï¼š
```bash
tasklist /fi "imagename eq nginx.exe"
```

åº”è¯¥çœ‹åˆ°ä¸¤ä¸ª nginx.exe è¿›ç¨‹ï¼ˆä¸€ä¸ªä¸»è¿›ç¨‹ï¼Œä¸€ä¸ªå·¥ä½œè¿›ç¨‹ï¼‰

---

#### 4. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š
```
http://localhost
```

---

### ğŸ› ï¸ Nginx å¸¸ç”¨å‘½ä»¤

#### Windows å‘½ä»¤

```bash
# å¯åŠ¨ Nginx
cd D:\nginx
start nginx

# å¿«é€Ÿåœæ­¢
nginx -s stop

# ä¼˜é›…åœæ­¢ï¼ˆç­‰å¾…è¯·æ±‚å®Œæˆï¼‰
nginx -s quit

# é‡æ–°åŠ è½½é…ç½®
nginx -s reload

# æµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
nginx -t

# æŸ¥çœ‹ç‰ˆæœ¬
nginx -v

# æŸ¥çœ‹è¿›ç¨‹
tasklist /fi "imagename eq nginx.exe"

# å¼ºåˆ¶å…³é—­æ‰€æœ‰ Nginx è¿›ç¨‹
taskkill /f /im nginx.exe
```

---

### ğŸ” æ¶æ„ç¤ºæ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æµè§ˆå™¨   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ http://localhost
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Nginx (80ç«¯å£)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é™æ€æ–‡ä»¶   â”‚   API åå‘ä»£ç†     â”‚
â”‚  (å‰ç«¯)    â”‚   /api/* â†’ åç«¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Spring Boot   â”‚
              â”‚  (8080ç«¯å£)    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¯·æ±‚æµç¨‹**ï¼š

1. **å‰ç«¯é¡µé¢è¯·æ±‚**ï¼š
   - æµè§ˆå™¨è®¿é—® `http://localhost`
   - Nginx è¿”å› `dist/index.html` é™æ€æ–‡ä»¶

2. **API è¯·æ±‚**ï¼š
   - å‰ç«¯è°ƒç”¨ `http://localhost/api/xxx`
   - Nginx å°†è¯·æ±‚è½¬å‘åˆ° `http://localhost:8080/api/xxx`
   - Spring Boot å¤„ç†è¯·æ±‚å¹¶è¿”å›æ•°æ®

---

### âœ… ä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | å¼€å‘æ¨¡å¼ | Nginx åå‘ä»£ç† |
|------|---------|----------------|
| **æ€§èƒ½** | â­â­â­ | â­â­â­â­â­ |
| **çƒ­æ›´æ–°** | âœ… | âŒ |
| **ç”Ÿäº§ç¯å¢ƒ** | âŒ | âœ… |
| **è·¨åŸŸå¤„ç†** | è‡ªåŠ¨ | æ— éœ€å¤„ç† |
| **è´Ÿè½½å‡è¡¡** | âŒ | âœ… |
| **é™æ€èµ„æºç¼“å­˜** | âŒ | âœ… |
| **Gzip å‹ç¼©** | âŒ | âœ… |
| **HTTPS æ”¯æŒ** | éœ€è¦é…ç½® | å®¹æ˜“é…ç½® |

---

### ğŸ¯ æ¨èä½¿ç”¨åœºæ™¯

#### å¼€å‘é˜¶æ®µ
```bash
npm run dev
```
- å®æ—¶è°ƒè¯•
- å¿«é€Ÿå¼€å‘
- çƒ­æ›´æ–°

#### ç”Ÿäº§éƒ¨ç½²
```bash
npm run build
# ä½¿ç”¨ Nginx éƒ¨ç½² dist ç›®å½•
```
- é«˜æ€§èƒ½
- ç¨³å®šå¯é 
- æ˜“äºç»´æŠ¤

---

### ğŸ”§ å¸¸è§é—®é¢˜

#### 1. å‰ç«¯å¯åŠ¨åï¼ŒAPI è¯·æ±‚ 404ï¼Ÿ

**åŸå› **ï¼šåç«¯æœªå¯åŠ¨æˆ–ç«¯å£ä¸å¯¹ã€‚

**è§£å†³**ï¼š
1. ç¡®ä¿åç«¯å·²å¯åŠ¨ï¼š`http://localhost:8080/api/doc.html`
2. æ£€æŸ¥å‰ç«¯ API é…ç½®ï¼š`src/utils/request.js`
   ```javascript
   const baseURL = 'http://localhost:8080/api'
   ```

---

#### 2. Nginx å¯åŠ¨åï¼Œè®¿é—® localhost æ˜¾ç¤º Nginx æ¬¢è¿é¡µï¼Ÿ

**åŸå› **ï¼šé…ç½®æ–‡ä»¶æœªç”Ÿæ•ˆæˆ–è·¯å¾„é”™è¯¯ã€‚

**è§£å†³**ï¼š
1. æ£€æŸ¥ `nginx.conf` ä¸­çš„ `root` è·¯å¾„æ˜¯å¦æ­£ç¡®
2. é‡æ–°åŠ è½½é…ç½®ï¼š`nginx -s reload`
3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š`logs/error.log`

---

#### 3. Nginx é…ç½®ä¿®æ”¹åä¸ç”Ÿæ•ˆï¼Ÿ

**è§£å†³**ï¼š
```bash
# æµ‹è¯•é…ç½®
nginx -t

# é‡æ–°åŠ è½½é…ç½®
nginx -s reload

# å¦‚æœè¿˜ä¸è¡Œï¼Œé‡å¯ Nginx
nginx -s stop
start nginx
```

---

#### 4. ç«¯å£ 80 è¢«å ç”¨ï¼Ÿ

**æŸ¥çœ‹å ç”¨æƒ…å†µ**ï¼š
```bash
netstat -ano | findstr :80
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä¿®æ”¹ Nginx ç›‘å¬ç«¯å£ï¼š
   ```nginx
   server {
       listen       8888;  # æ”¹ä¸ºå…¶ä»–ç«¯å£
       ...
   }
   ```
2. è®¿é—®æ—¶ä½¿ç”¨ï¼š`http://localhost:8888`

---

### ğŸ“š å®Œæ•´å¯åŠ¨æµç¨‹ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

#### 1. å¯åŠ¨ MySQL
```bash
net start mysql
```

#### 2. å¯åŠ¨ Redisï¼ˆå¯é€‰ï¼‰
```bash
redis-server
```

#### 3. å¯åŠ¨åç«¯
åœ¨ IntelliJ IDEA ä¸­è¿è¡Œ `SupermarketApplication`

æˆ–å‘½ä»¤è¡Œï¼š
```bash
cd D:\code\supermarket-system\supermarket-backend
mvn spring-boot:run
```

#### 4. æ„å»ºå‰ç«¯
```bash
cd D:\code\supermarket-system\supermarket-frontend
npm run build
```

#### 5. å¯åŠ¨ Nginx
```bash
cd D:\nginx
start nginx
```

#### 6. è®¿é—®åº”ç”¨
æ‰“å¼€æµè§ˆå™¨ï¼š`http://localhost`

---

### ğŸ‰ å¤§åŠŸå‘Šæˆï¼

- **å‰ç«¯åœ°å€**ï¼šhttp://localhost
- **åç«¯ Swagger**ï¼šhttp://localhost:8080/api/doc.html
- **é»˜è®¤è´¦å·**ï¼šadmin
- **é»˜è®¤å¯†ç **ï¼š123456

---

### ğŸ’¡ è¿›é˜¶é…ç½®

#### é…ç½® HTTPSï¼ˆå¯é€‰ï¼‰

```nginx
server {
    listen       443 ssl;
    server_name  localhost;
    
    ssl_certificate      cert/server.crt;
    ssl_certificate_key  cert/server.key;
    
    # ... å…¶ä»–é…ç½®åŒä¸Š
}
```

#### è´Ÿè½½å‡è¡¡ï¼ˆå¤šåç«¯å®ä¾‹ï¼‰

```nginx
upstream backend {
    server 127.0.0.1:8080;
    server 127.0.0.1:8081;
    server 127.0.0.1:8082;
}
```

#### é™æ€èµ„æºç¼“å­˜

```nginx
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
    expires 7d;
}
```

---

## ğŸ“§ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…ï¼š
- Nginx å®˜æ–¹æ–‡æ¡£ï¼šhttp://nginx.org/en/docs/
- Vite å®˜æ–¹æ–‡æ¡£ï¼šhttps://vitejs.dev/
- Vue 3 å®˜æ–¹æ–‡æ¡£ï¼šhttps://vuejs.org/



