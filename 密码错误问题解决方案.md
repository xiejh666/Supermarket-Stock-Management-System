# å¯†ç é”™è¯¯é—®é¢˜è§£å†³æ–¹æ¡ˆ ğŸ”

## ğŸ” é—®é¢˜ç°è±¡

- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`123456`
- é”™è¯¯æç¤ºï¼š**å¯†ç é”™è¯¯**

---

## ğŸ“‹ å¿«é€Ÿæ’æŸ¥æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰ç”¨æˆ·æ•°æ®

**åœ¨ DataGrip æˆ– MySQL å‘½ä»¤è¡Œä¸­æ‰§è¡Œ**ï¼š

```sql
-- 1. ä½¿ç”¨æ•°æ®åº“
USE supermarket_db;

-- 2. æŸ¥çœ‹ admin ç”¨æˆ·
SELECT * FROM sys_user WHERE username = 'admin';
```

#### æƒ…å†µ Aï¼šæŸ¥è¯¢ç»“æœä¸ºç©ºï¼ˆæ²¡æœ‰æ•°æ®ï¼‰âŒ

**è¯´æ˜**ï¼šæ•°æ®åº“æ²¡æœ‰å¯¼å…¥åˆå§‹æ•°æ®ã€‚

**è§£å†³æ–¹æ¡ˆ** â†’ è·³åˆ° [æ–¹æ¡ˆä¸€ï¼šé‡æ–°å¯¼å…¥æ•°æ®](#æ–¹æ¡ˆä¸€é‡æ–°å¯¼å…¥æ•°æ®)

---

#### æƒ…å†µ Bï¼šæŸ¥è¯¢åˆ°äº†æ•°æ® âœ…

**ç¤ºä¾‹ç»“æœ**ï¼š
```
+----+----------+--------------------------------------------------------------+------------+-------------+--------+---------+
| id | username | password                                                     | real_name  | phone       | status | role_id |
+----+----------+--------------------------------------------------------------+------------+-------------+--------+---------+
|  1 | admin    | $2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iwK8pDPW | ç®¡ç†å‘˜     | 13800138000 |      1 |       1 |
+----+----------+--------------------------------------------------------------+------------+-------------+--------+---------+
```

**è¯´æ˜**ï¼šç”¨æˆ·å­˜åœ¨ï¼Œä½†å¯†ç å¯èƒ½ä¸å¯¹ã€‚

**ç»§ç»­æ£€æŸ¥** â†’ è·³åˆ° [æ­¥éª¤ 2](#æ­¥éª¤-2éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®)

---

### æ­¥éª¤ 2ï¼šéªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®

**è¿è¡Œå¯†ç æµ‹è¯•å·¥å…·**ï¼š

```bash
cd D:\code\supermarket-system\supermarket-backend
mvn test-compile
mvn exec:java -Dexec.mainClass="com.supermarket.PasswordTest"
```

**æˆ–è€…åœ¨ IDEA ä¸­**ï¼š
1. å³é”®ç‚¹å‡» `PasswordTest.java`
2. é€‰æ‹© "Run 'PasswordTest.main()'"

**æŸ¥çœ‹è¾“å‡º**ï¼š

#### æƒ…å†µ Aï¼šéªŒè¯ç»“æœæ˜¾ç¤º "âœ… åŒ¹é…æˆåŠŸ"

**è¯´æ˜**ï¼šå¯†ç å“ˆå¸Œæ˜¯æ­£ç¡®çš„ï¼Œé—®é¢˜å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹ã€‚

**è§£å†³æ–¹æ¡ˆ** â†’ è·³åˆ° [æ–¹æ¡ˆä¸‰ï¼šå…¶ä»–é—®é¢˜æ’æŸ¥](#æ–¹æ¡ˆä¸‰å…¶ä»–é—®é¢˜æ’æŸ¥)

---

#### æƒ…å†µ Bï¼šéªŒè¯ç»“æœæ˜¾ç¤º "âŒ åŒ¹é…å¤±è´¥"

**è¯´æ˜**ï¼šæ•°æ®åº“ä¸­çš„å¯†ç å“ˆå¸Œä¸æ­£ç¡®ã€‚

**è§£å†³æ–¹æ¡ˆ** â†’ è·³åˆ° [æ–¹æ¡ˆäºŒï¼šæ›´æ–°å¯†ç ](#æ–¹æ¡ˆäºŒæ›´æ–°å¯†ç )

---

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šé‡æ–°å¯¼å…¥æ•°æ®

å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰ç”¨æˆ·æ•°æ®ï¼Œéœ€è¦é‡æ–°å¯¼å…¥ã€‚

#### æ­¥éª¤ 1ï¼šç¡®è®¤æ•°æ®åº“å­˜åœ¨

```sql
SHOW DATABASES LIKE 'supermarket_db';
```

å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®åº“ï¼š
```sql
CREATE DATABASE supermarket_db 
DEFAULT CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

#### æ­¥éª¤ 2ï¼šä½¿ç”¨ DataGrip å¯¼å…¥æ•°æ®

1. è¿æ¥åˆ° MySQL
2. é€‰æ‹© `supermarket_db` æ•°æ®åº“
3. æ‰“å¼€ `sql/schema.sql` æ–‡ä»¶
4. ç‚¹å‡» Executeï¼ˆæ‰§è¡Œï¼‰æŒ‰é’® â–¶ï¸
5. æ‰“å¼€ `sql/data.sql` æ–‡ä»¶
6. ç‚¹å‡» Executeï¼ˆæ‰§è¡Œï¼‰æŒ‰é’® â–¶ï¸

#### æ­¥éª¤ 3ï¼šéªŒè¯å¯¼å…¥æˆåŠŸ

```sql
-- æŸ¥çœ‹è¡¨æ•°é‡
USE supermarket_db;
SHOW TABLES;

-- åº”è¯¥æ˜¾ç¤º 16 ä¸ªè¡¨ï¼š
-- category
-- inventory
-- inventory_log
-- product
-- purchase_order
-- purchase_order_item
-- sale_order
-- sale_order_item
-- supplier
-- sys_permission
-- sys_role
-- sys_role_permission
-- sys_user

-- æŸ¥çœ‹ç”¨æˆ·æ•°æ®
SELECT COUNT(*) as user_count FROM sys_user;
-- åº”è¯¥è¿”å› 3ï¼ˆadmin, purchaser, cashierï¼‰

-- æŸ¥çœ‹ admin ç”¨æˆ·
SELECT * FROM sys_user WHERE username = 'admin';
```

#### æ­¥éª¤ 4ï¼šé‡æ–°æµ‹è¯•ç™»å½•

è®¿é—® http://localhost:3000ï¼Œä½¿ç”¨ `admin` / `123456` ç™»å½•ã€‚

---

### æ–¹æ¡ˆäºŒï¼šæ›´æ–°å¯†ç 

å¦‚æœå¯†ç å“ˆå¸Œä¸æ­£ç¡®ï¼Œéœ€è¦æ›´æ–°æ•°æ®åº“ä¸­çš„å¯†ç ã€‚

#### æ­¥éª¤ 1ï¼šç”Ÿæˆæ–°çš„å¯†ç å“ˆå¸Œ

**è¿è¡Œ PasswordTest.java**ï¼Œä¼šè¾“å‡ºæ–°çš„å¯†ç å“ˆå¸Œã€‚

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
æ–°ç”Ÿæˆçš„å¯†ç å“ˆå¸Œï¼ˆå¯ç”¨äºæ›´æ–°æ•°æ®åº“ï¼‰:
1. $2a$10$8ZwKXjDxqMc.EaJ9.5xLxO5KQq8vV7X3RYn.fVXkPTYmYp8Xr7QIi
   éªŒè¯: âœ…
2. $2a$10$9YvNYkEzrNd.FbK0.6yMyP6LRr9wW8Y4SZo.gWYlQUZnZq9Ys8RJj
   éªŒè¯: âœ…
3. $2a$10$0ZxOZlGAsOe.GcL1.7zNzQ7MSs0xX9Z5TApgXZmRVaApAq0Zt9SKm
   éªŒè¯: âœ…
```

#### æ­¥éª¤ 2ï¼šé€‰æ‹©ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œæ›´æ–°æ•°æ®åº“

**åœ¨ DataGrip ä¸­æ‰§è¡Œ**ï¼š

```sql
USE supermarket_db;

-- æ›´æ–° admin ç”¨æˆ·çš„å¯†ç ï¼ˆæ›¿æ¢ä¸ºæ–°ç”Ÿæˆçš„å“ˆå¸Œå€¼ï¼‰
UPDATE sys_user 
SET password = '$2a$10$8ZwKXjDxqMc.EaJ9.5xLxO5KQq8vV7X3RYn.fVXkPTYmYp8Xr7QIi'
WHERE username = 'admin';

-- éªŒè¯æ›´æ–°
SELECT username, password FROM sys_user WHERE username = 'admin';
```

#### æ­¥éª¤ 3ï¼šé‡æ–°æµ‹è¯•ç™»å½•

è®¿é—® http://localhost:3000ï¼Œä½¿ç”¨ `admin` / `123456` ç™»å½•ã€‚

---

### æ–¹æ¡ˆä¸‰ï¼šå…¶ä»–é—®é¢˜æ’æŸ¥

å¦‚æœå¯†ç éªŒè¯é€šè¿‡äº†ï¼Œä½†è¿˜æ˜¯ç™»å½•å¤±è´¥ï¼Œå¯èƒ½æ˜¯ä»¥ä¸‹åŸå› ï¼š

#### 1. ç”¨æˆ·çŠ¶æ€è¢«ç¦ç”¨

**æ£€æŸ¥**ï¼š
```sql
SELECT username, status FROM sys_user WHERE username = 'admin';
```

**status åº”è¯¥æ˜¯ 1ï¼ˆå¯ç”¨ï¼‰**ï¼Œå¦‚æœæ˜¯ 0ï¼Œè¯´æ˜è´¦å·è¢«ç¦ç”¨ã€‚

**ä¿®å¤**ï¼š
```sql
UPDATE sys_user SET status = 1 WHERE username = 'admin';
```

---

#### 2. è§’è‰²æ•°æ®ç¼ºå¤±

**æ£€æŸ¥**ï¼š
```sql
SELECT u.username, u.role_id, r.role_name, r.role_code
FROM sys_user u
LEFT JOIN sys_role r ON u.role_id = r.id
WHERE u.username = 'admin';
```

**åº”è¯¥æ˜¾ç¤º**ï¼š
```
username | role_id | role_name | role_code
admin    | 1       | ç®¡ç†å‘˜    | ADMIN
```

å¦‚æœ `role_name` ä¸º NULLï¼Œè¯´æ˜è§’è‰²æ•°æ®ç¼ºå¤±ã€‚

**ä¿®å¤**ï¼šé‡æ–°å¯¼å…¥ `sql/data.sql` ä¸­çš„è§’è‰²æ•°æ®ã€‚

---

#### 3. åç«¯æ—¥å¿—æŸ¥çœ‹

**åœ¨åç«¯æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†é”™è¯¯**ï¼š

```
# åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼çš„æ—¥å¿—ï¼š
DEBUG c.s.service.impl.AuthServiceImpl - ç”¨æˆ·ç™»å½•: admin
ERROR c.s.service.impl.AuthServiceImpl - å¯†ç éªŒè¯å¤±è´¥
```

å¦‚æœçœ‹åˆ°å…¶ä»–é”™è¯¯ï¼Œè¯·æŠŠé”™è¯¯ä¿¡æ¯å‘Šè¯‰æˆ‘ã€‚

---

#### 4. BCryptPasswordEncoder é…ç½®é—®é¢˜

**æ£€æŸ¥ SecurityConfig.java**ï¼š

```java
@Bean
public BCryptPasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
}
```

åº”è¯¥å·²ç»é…ç½®äº†ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåç«¯ä¼šæŠ¥é”™ã€‚

---

## ğŸ¯ æœ€ç®€å•çš„è§£å†³æ–¹æ³•ï¼ˆæ¨èï¼‰

å¦‚æœä»¥ä¸Šéƒ½ä¸ç¡®å®šï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼š

### å®Œå…¨é‡ç½®æ•°æ®åº“

```sql
-- 1. åˆ é™¤æ•°æ®åº“
DROP DATABASE IF EXISTS supermarket_db;

-- 2. é‡æ–°åˆ›å»º
CREATE DATABASE supermarket_db 
DEFAULT CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

-- 3. ä½¿ç”¨æ•°æ®åº“
USE supermarket_db;

-- 4. åœ¨ DataGrip ä¸­ä¾æ¬¡æ‰§è¡Œï¼š
--    - sql/schema.sql
--    - sql/data.sql
```

ç„¶åé‡å¯åç«¯ï¼Œé‡æ–°æµ‹è¯•ç™»å½•ã€‚

---

## ğŸ” è°ƒè¯•æŠ€å·§

### åœ¨ AuthServiceImpl.java ä¸­æ·»åŠ æ—¥å¿—

<function_calls>
<invoke name="search_replace">
<parameter name="file_path">supermarket-backend/src/main/java/com/supermarket/service/impl/AuthServiceImpl.java

